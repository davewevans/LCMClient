@page "/pendingnarrations"


@using LCMClient.Features.Auth
@using LCMClient.Features.Shared
@using LCMClient.Helpers
@using LCMClient.Features.Shared.Repository.Contracts
@using LCMClient.Features.Shared.Models
@using LCMClient.Features.Admin.Models

@implements IDisposable

@inject IAccountsRepository accountsRepository
@inject IUserRepository userRepository
@inject NavigationManager navigationManager
@inject ILoginService loginService
@inject IJSRuntime jsRuntime
@inject IDialogService Dialog
@inject IMatToaster Toaster
@inject PendingNarrationsService PendingNarrationsService

@attribute [Authorize(Roles = "Admin, NarrationApprover")]



<div class="m-8">
    <div class="flex justify-between mb-6">
        <div class="flex ml-6">
            <div class="mr-2 text-blue-800 fill-current">
              <?xml version="1.0" encoding="UTF-8"?>
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24pt" height="24pt" viewBox="0 0 24 24" version="1.1">
              <g id="surface1">
              <path style=" stroke:none;fill-rule:nonzero;fill:rgb(11.764706%,25.098039%,68.627451%);fill-opacity:1;" d="M 15.652344 22.625 L 20.433594 17.84375 L 15.652344 17.84375 Z M 15.652344 22.625 "/>
              <path style=" stroke:none;fill-rule:nonzero;fill:rgb(11.764706%,25.098039%,68.627451%);fill-opacity:1;" d="M 20.164062 3.578125 L 10.484375 3.578125 C 10.492188 3.648438 10.496094 3.722656 10.496094 3.792969 L 10.496094 7.660156 C 10.496094 8.726562 9.628906 9.59375 8.5625 9.59375 C 7.496094 9.59375 6.628906 8.726562 6.628906 7.660156 L 6.628906 6.800781 C 6.628906 6.445312 6.917969 6.15625 7.273438 6.15625 C 7.628906 6.15625 7.917969 6.445312 7.917969 6.800781 L 7.917969 7.660156 C 7.917969 8.015625 8.207031 8.304688 8.5625 8.304688 C 8.917969 8.304688 9.207031 8.015625 9.207031 7.660156 L 9.207031 3.792969 C 9.207031 3.722656 9.199219 3.648438 9.191406 3.578125 L 6.214844 3.578125 C 6.320312 2.851562 6.949219 2.289062 7.703125 2.289062 C 8.457031 2.289062 9.085938 2.851562 9.191406 3.578125 L 10.484375 3.578125 C 10.378906 2.136719 9.171875 1 7.703125 1 C 6.234375 1 5.027344 2.136719 4.921875 3.578125 L 3.835938 3.578125 C 3.480469 3.578125 3.191406 3.867188 3.191406 4.222656 L 3.191406 22.355469 C 3.191406 22.710938 3.480469 23 3.835938 23 L 14.363281 23 L 14.363281 17.199219 C 14.363281 16.84375 14.652344 16.554688 15.007812 16.554688 L 20.808594 16.554688 L 20.808594 4.222656 C 20.808594 3.867188 20.519531 3.578125 20.164062 3.578125 Z M 12.429688 20.421875 L 6.414062 20.421875 C 6.058594 20.421875 5.769531 20.132812 5.769531 19.777344 C 5.769531 19.421875 6.058594 19.132812 6.414062 19.132812 L 12.429688 19.132812 C 12.785156 19.132812 13.074219 19.421875 13.074219 19.777344 C 13.074219 20.132812 12.785156 20.421875 12.429688 20.421875 Z M 12.429688 17.84375 L 6.414062 17.84375 C 6.058594 17.84375 5.769531 17.554688 5.769531 17.199219 C 5.769531 16.84375 6.058594 16.554688 6.414062 16.554688 L 12.429688 16.554688 C 12.785156 16.554688 13.074219 16.84375 13.074219 17.199219 C 13.074219 17.554688 12.785156 17.84375 12.429688 17.84375 Z M 17.585938 15.265625 L 6.414062 15.265625 C 6.058594 15.265625 5.769531 14.976562 5.769531 14.621094 C 5.769531 14.265625 6.058594 13.976562 6.414062 13.976562 L 17.585938 13.976562 C 17.941406 13.976562 18.230469 14.265625 18.230469 14.621094 C 18.230469 14.976562 17.941406 15.265625 17.585938 15.265625 Z M 17.585938 12.6875 L 6.414062 12.6875 C 6.058594 12.6875 5.769531 12.398438 5.769531 12.042969 C 5.769531 11.6875 6.058594 11.398438 6.414062 11.398438 L 17.585938 11.398438 C 17.941406 11.398438 18.230469 11.6875 18.230469 12.042969 C 18.230469 12.398438 17.941406 12.6875 17.585938 12.6875 Z M 17.585938 10.109375 L 12 10.109375 C 11.644531 10.109375 11.355469 9.820312 11.355469 9.464844 C 11.355469 9.109375 11.644531 8.820312 12 8.820312 L 17.585938 8.820312 C 17.941406 8.820312 18.230469 9.109375 18.230469 9.464844 C 18.230469 9.820312 17.941406 10.109375 17.585938 10.109375 Z M 17.585938 7.53125 L 12 7.53125 C 11.644531 7.53125 11.355469 7.242188 11.355469 6.886719 C 11.355469 6.53125 11.644531 6.242188 12 6.242188 L 17.585938 6.242188 C 17.941406 6.242188 18.230469 6.53125 18.230469 6.886719 C 18.230469 7.242188 17.941406 7.53125 17.585938 7.53125 Z M 17.585938 7.53125 "/>
              </g>
              </svg>

            </div>
            <div>
            <h3 class="text-blue-800 font-semibold text-4xl">Narrations Pending Approval</h3>
            </div>
        </div>
    </div>

    <IndexNarrations />
</div>


@code {
    
    protected override async Task OnInitializedAsync()
    {
        await PendingNarrationsService.SetPendingNarrationsCount();
        PendingNarrationsService.OnChange += StateHasChanged;
    }

   
    public void Dispose()
    {
        PendingNarrationsService.OnChange -= StateHasChanged;
    }

}